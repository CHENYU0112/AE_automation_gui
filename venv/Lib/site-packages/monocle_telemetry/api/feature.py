from collections.abc import Iterable

from monocle_telemetry.client import MonocleClient
from monocle_telemetry.util import log_errors, run_async

__all__ = ["track_feature", "track_features", "MonocleClient"]


@run_async
@log_errors
def track_feature(
    project: str,
    tool: str,
    version: str,
    feature: str,
    misc: str = "",
):
    with MonocleClient() as client:
        client.create_feature(project=project, tool=tool, version=version, feature=feature, misc=misc)


@run_async
@log_errors
def track_features(features: Iterable[dict]):
    with MonocleClient() as client:
        client.create_features(features=features)
