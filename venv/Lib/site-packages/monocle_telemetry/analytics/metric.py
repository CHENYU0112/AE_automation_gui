from collections.abc import Iterable

import pandas as pd

__all__ = [
    "to_dataframe",
]


def to_dataframe(metrics: Iterable[dict]) -> pd.DataFrame:
    """
    Converts response data from a metric search query into a Pandas dataframe.
    """
    df = pd.DataFrame.from_records(metrics)
    df.timestamp = pd.to_datetime(df.timestamp)
    df["date"] = df.timestamp.dt.date
    df.set_index("timestamp", inplace=True)
    return df
