from __future__ import annotations

from ctypes import byref

from pverify.core.lab.ivi.headers.ivi import *
from pverify.core.lab.ivi.helper import *
from pverify.core.lab.ivi.ivi_base_classes import IVICDriverWrapper

from . import tkafg3k_const as const
from .tkafg3k_const import *


class tkafg3k_dllwrap(IVICDriverWrapper):
    def __init__(self):
        super().__init__()
        self._dll = load_dll("tkafg3k_32.dll", "tkafg3k_64.dll", __file__)
        """:type : ctypes.WinDLL"""

    @property
    def dll(self):
        return self._dll

    @property
    def drivername(self):
        return "tkafg3k"

    @property
    def const(self):
        return const

    def init(self, resourceName, IDQuery, resetDevice):
        vi = ViSession()
        status = self.dll.tkafg3k_init(ViRsrc(resourceName), ViBoolean(IDQuery), ViBoolean(resetDevice), byref(vi))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return int(vi.value)

    def InitWithOptions(self, resourceName, IDQuery, resetDevice, optionString):
        newVi = ViSession()
        status = self.dll.tkafg3k_InitWithOptions(
            ViRsrc(resourceName),
            ViBoolean(IDQuery),
            ViBoolean(resetDevice),
            ViConstString(optionString),
            byref(newVi),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return int(newVi.value)

    def close(self, vi):
        status = self.dll.tkafg3k_close(ViSession(vi))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def GetNextCoercionRecord(self, vi, bufferSize):
        record = ARRAY_ViChar(1024)
        status = self.dll.tkafg3k_GetNextCoercionRecord(ViSession(vi), ViInt32(bufferSize), record)
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return decode(record)

    def LockSession(self, vi):
        callerHasLock = ViBoolean()
        status = self.dll.tkafg3k_LockSession(ViSession(vi), byref(callerHasLock))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return bool(callerHasLock.value)

    def UnlockSession(self, vi):
        callerHasLock = ViBoolean()
        status = self.dll.tkafg3k_UnlockSession(ViSession(vi), byref(callerHasLock))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return bool(callerHasLock.value)

    def GetChannelName(self, vi, index, bufferSize):
        name = ARRAY_ViChar(1024)
        status = self.dll.tkafg3k_GetChannelName(ViSession(vi), ViInt32(index), ViInt32(bufferSize), name)
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return decode(name)

    def ConfigureActiveMemory(self, vi, activeMemory):
        status = self.dll.tkafg3k_ConfigureActiveMemory(ViSession(vi), ViInt32(activeMemory))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureOperationMode(self, vi, channelName, outputMode):
        status = self.dll.tkafg3k_ConfigureOperationMode(ViSession(vi), ViConstString(channelName), ViInt32(outputMode))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureOutputMode(self, vi, outputMode):
        status = self.dll.tkafg3k_ConfigureOutputMode(ViSession(vi), ViInt32(outputMode))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureOutputModeByChannel(self, vi, channelName, outputMode):
        status = self.dll.tkafg3k_ConfigureOutputModeByChannel(
            ViSession(vi), ViConstString(channelName), ViInt32(outputMode)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureRefClockSource(self, vi, refClockSource):
        status = self.dll.tkafg3k_ConfigureRefClockSource(ViSession(vi), ViInt32(refClockSource))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureOutputImpedance(self, vi, channelName, outputImpedance):
        status = self.dll.tkafg3k_ConfigureOutputImpedance(
            ViSession(vi), ViConstString(channelName), ViReal64(outputImpedance)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureOutputEnabled(self, vi, channelName, enabled):
        status = self.dll.tkafg3k_ConfigureOutputEnabled(ViSession(vi), ViConstString(channelName), ViBoolean(enabled))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def InitiateGeneration(self, vi):
        status = self.dll.tkafg3k_InitiateGeneration(ViSession(vi))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def AbortGeneration(self, vi):
        status = self.dll.tkafg3k_AbortGeneration(ViSession(vi))
        if status == TKAFG3K_ERROR_ABORT_GENERATION_UNSUPPORTED:
            return
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureStandardWaveform(self, vi, channelName, waveform, amplitude, dcOffset, frequency, startPhase):
        status = self.dll.tkafg3k_ConfigureStandardWaveform(
            ViSession(vi),
            ViConstString(channelName),
            ViInt32(waveform),
            ViReal64(amplitude),
            ViReal64(dcOffset),
            ViReal64(frequency),
            ViReal64(startPhase),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureRampSymmetry(self, vi, channelName, rampSymmetry):
        status = self.dll.tkafg3k_ConfigureRampSymmetry(
            ViSession(vi), ViConstString(channelName), ViReal64(rampSymmetry)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigurePulseWaveform(self, vi, channelName, dutyCycle, leadingEdgeTime, trailingEdgeTime):
        status = self.dll.tkafg3k_ConfigurePulseWaveform(
            ViSession(vi),
            ViConstString(channelName),
            ViReal64(dutyCycle),
            ViReal64(leadingEdgeTime),
            ViReal64(trailingEdgeTime),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigurePulseDelay(self, vi, channelName, delay):
        status = self.dll.tkafg3k_ConfigurePulseDelay(ViSession(vi), ViConstString(channelName), ViReal64(delay))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureSampleRate(self, vi, sampleRate):
        status = self.dll.tkafg3k_ConfigureSampleRate(ViSession(vi), ViReal64(sampleRate))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def QueryArbWfmCapabilities(self, vi):
        maxNumWfms = ViInt32()
        wfmQuantum = ViInt32()
        minWfmSize = ViInt32()
        maxWfmSize = ViInt32()
        status = self.dll.tkafg3k_QueryArbWfmCapabilities(
            ViSession(vi),
            byref(maxNumWfms),
            byref(wfmQuantum),
            byref(minWfmSize),
            byref(maxWfmSize),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        maxNumWfms = int(maxNumWfms.value)
        wfmQuantum = int(wfmQuantum.value)
        minWfmSize = int(minWfmSize.value)
        maxWfmSize = int(maxWfmSize.value)
        return maxNumWfms, wfmQuantum, minWfmSize, maxWfmSize

    def CreateArbWaveform(self, vi, wfmSize, wfmData):
        _wfmData = (ViReal64 * len(wfmData))(*wfmData)
        wfmHandle = ViInt32()
        status = self.dll.tkafg3k_CreateArbWaveform(ViSession(vi), ViInt32(wfmSize), _wfmData, byref(wfmHandle))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return int(wfmHandle.value)

    def CreateLineInterpolateArbWfm(self, vi, wfmSize, startPointData, endPointData):
        wfmHandle = ViInt32()
        status = self.dll.tkafg3k_CreateLineInterpolateArbWfm(
            ViSession(vi),
            ViInt32(wfmSize),
            ViReal64(startPointData),
            ViReal64(endPointData),
            byref(wfmHandle),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return int(wfmHandle.value)

    def CreateStandardShapeArbWfm(self, vi, wfmSize, wfmType):
        wfmHandle = ViInt32()
        status = self.dll.tkafg3k_CreateStandardShapeArbWfm(
            ViSession(vi), ViInt32(wfmSize), ViInt32(wfmType), byref(wfmHandle)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return int(wfmHandle.value)

    def GetArbitraryWaveformBySlot(self, vi, slot):
        wfmHandle = ViInt32()
        status = self.dll.tkafg3k_GetArbitraryWaveformBySlot(ViSession(vi), ViInt32(slot), byref(wfmHandle))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return int(wfmHandle.value)

    def CreateArbWaveformBySlot(self, vi, slot, wfmSize, wfmData, overwrite):
        _wfmData = (ViReal64 * len(wfmData))(*wfmData)
        wfmHandle = ViInt32()
        status = self.dll.tkafg3k_CreateArbWaveformBySlot(
            ViSession(vi),
            ViInt32(slot),
            ViInt32(wfmSize),
            _wfmData,
            ViBoolean(overwrite),
            byref(wfmHandle),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return int(wfmHandle.value)

    def CreateLineInterpolateArbWfmBySlot(self, vi, slot, wfmSize, startPointData, endPointData, overwrite):
        wfmHandle = ViInt32()
        status = self.dll.tkafg3k_CreateLineInterpolateArbWfmBySlot(
            ViSession(vi),
            ViInt32(slot),
            ViInt32(wfmSize),
            ViReal64(startPointData),
            ViReal64(endPointData),
            ViBoolean(overwrite),
            byref(wfmHandle),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return int(wfmHandle.value)

    def CreateStandardShapeArbWfmBySlot(self, vi, slot, wfmSize, wfmType, overwrite):
        wfmHandle = ViInt32()
        status = self.dll.tkafg3k_CreateStandardShapeArbWfmBySlot(
            ViSession(vi),
            ViInt32(slot),
            ViInt32(wfmSize),
            ViInt32(wfmType),
            ViBoolean(overwrite),
            byref(wfmHandle),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return int(wfmHandle.value)

    def ClearArbWaveform(self, vi, wfmHandle):
        status = self.dll.tkafg3k_ClearArbWaveform(ViSession(vi), ViInt32(wfmHandle))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ClearArbWaveformBySlot(self, vi, slot):
        status = self.dll.tkafg3k_ClearArbWaveformBySlot(ViSession(vi), ViInt32(slot))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureArbWaveform(self, vi, channelName, wfmHandle, arbGain, arbOffset):
        status = self.dll.tkafg3k_ConfigureArbWaveform(
            ViSession(vi),
            ViConstString(channelName),
            ViInt32(wfmHandle),
            ViReal64(arbGain),
            ViReal64(arbOffset),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureArbFrequency(self, vi, channelName, arbFrequency):
        status = self.dll.tkafg3k_ConfigureArbFrequency(
            ViSession(vi), ViConstString(channelName), ViReal64(arbFrequency)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureTriggerSource(self, vi, channelName, trigSource):
        status = self.dll.tkafg3k_ConfigureTriggerSource(ViSession(vi), ViConstString(channelName), ViInt32(trigSource))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ForceTrigger(self, vi):
        status = self.dll.tkafg3k_ForceTrigger(ViSession(vi))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureTriggerOutputMode(self, vi, outputMode):
        status = self.dll.tkafg3k_ConfigureTriggerOutputMode(ViSession(vi), ViInt32(outputMode))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureInternalTriggerRate(self, vi, rate):
        status = self.dll.tkafg3k_ConfigureInternalTriggerRate(ViSession(vi), ViReal64(rate))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureExternalTriggerSlope(self, vi, triggerSlope):
        status = self.dll.tkafg3k_ConfigureExternalTriggerSlope(ViSession(vi), ViInt32(triggerSlope))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureBurstEnabled(self, vi, channelName, enabled):
        status = self.dll.tkafg3k_ConfigureBurstEnabled(ViSession(vi), ViConstString(channelName), ViBoolean(enabled))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureBurstCount(self, vi, channelName, burstCount):
        status = self.dll.tkafg3k_ConfigureBurstCount(ViSession(vi), ViConstString(channelName), ViInt32(burstCount))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureBurstMode(self, vi, channelName, burstMode):
        status = self.dll.tkafg3k_ConfigureBurstMode(ViSession(vi), ViConstString(channelName), ViInt32(burstMode))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureBurstDelay(self, vi, channelName, burstDelay):
        status = self.dll.tkafg3k_ConfigureBurstDelay(ViSession(vi), ViConstString(channelName), ViReal64(burstDelay))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureSweepEnabled(self, vi, channelName, enabled):
        status = self.dll.tkafg3k_ConfigureSweepEnabled(ViSession(vi), ViConstString(channelName), ViBoolean(enabled))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureSweep(self, vi, channelName, startFrequency, stopFrequency, time, type):
        status = self.dll.tkafg3k_ConfigureSweep(
            ViSession(vi),
            ViConstString(channelName),
            ViReal64(startFrequency),
            ViReal64(stopFrequency),
            ViReal64(time),
            ViInt32(type),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureSweepEx(
        self,
        vi,
        channelName,
        startFrequency,
        stopFrequency,
        time,
        holdTime,
        returnTime,
        type,
    ):
        status = self.dll.tkafg3k_ConfigureSweepEx(
            ViSession(vi),
            ViConstString(channelName),
            ViReal64(startFrequency),
            ViReal64(stopFrequency),
            ViReal64(time),
            ViReal64(holdTime),
            ViReal64(returnTime),
            ViInt32(type),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureSweepMode(self, vi, channelName, sweepMode):
        status = self.dll.tkafg3k_ConfigureSweepMode(ViSession(vi), ViConstString(channelName), ViInt32(sweepMode))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureNoiseAppendantEnabled(self, vi, channelName, enabled):
        status = self.dll.tkafg3k_ConfigureNoiseAppendantEnabled(
            ViSession(vi), ViConstString(channelName), ViBoolean(enabled)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureNoiseLevel(self, vi, channelName, level):
        status = self.dll.tkafg3k_ConfigureNoiseLevel(ViSession(vi), ViConstString(channelName), ViReal64(level))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureExternalAppendEnabled(self, vi, channelName, enabled):
        status = self.dll.tkafg3k_ConfigureExternalAppendEnabled(
            ViSession(vi), ViConstString(channelName), ViBoolean(enabled)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureAMEnabled(self, vi, channelName, enabled):
        status = self.dll.tkafg3k_ConfigureAMEnabled(ViSession(vi), ViConstString(channelName), ViBoolean(enabled))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureAMSource(self, vi, channelName, source):
        status = self.dll.tkafg3k_ConfigureAMSource(ViSession(vi), ViConstString(channelName), ViInt32(source))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureAMInternal(self, vi, amDepth, amWaveform, amFrequency):
        status = self.dll.tkafg3k_ConfigureAMInternal(
            ViSession(vi), ViReal64(amDepth), ViInt32(amWaveform), ViReal64(amFrequency)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureAMInternalByChannel(self, vi, channelName, amDepth, amWaveform, amFrequency):
        status = self.dll.tkafg3k_ConfigureAMInternalByChannel(
            ViSession(vi),
            ViConstString(channelName),
            ViReal64(amDepth),
            ViInt32(amWaveform),
            ViReal64(amFrequency),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureAMExternalByChannel(self, vi, channelName, amDepth):
        status = self.dll.tkafg3k_ConfigureAMExternalByChannel(
            ViSession(vi), ViConstString(channelName), ViReal64(amDepth)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureFMEnabled(self, vi, channelName, enabled):
        status = self.dll.tkafg3k_ConfigureFMEnabled(ViSession(vi), ViConstString(channelName), ViBoolean(enabled))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureFMSource(self, vi, channelName, source):
        status = self.dll.tkafg3k_ConfigureFMSource(ViSession(vi), ViConstString(channelName), ViInt32(source))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureFMInternal(self, vi, fmDeviation, fmWaveform, fmFrequency):
        status = self.dll.tkafg3k_ConfigureFMInternal(
            ViSession(vi),
            ViReal64(fmDeviation),
            ViInt32(fmWaveform),
            ViReal64(fmFrequency),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureFMInternalByChannel(self, vi, channelName, fmDeviance, fmWaveform, fmFrequency):
        status = self.dll.tkafg3k_ConfigureFMInternalByChannel(
            ViSession(vi),
            ViConstString(channelName),
            ViReal64(fmDeviance),
            ViInt32(fmWaveform),
            ViReal64(fmFrequency),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureFMExternalByChannel(self, vi, channelName, fmDeviance):
        status = self.dll.tkafg3k_ConfigureFMExternalByChannel(
            ViSession(vi), ViConstString(channelName), ViReal64(fmDeviance)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigurePMEnabled(self, vi, channelName, enabled):
        status = self.dll.tkafg3k_ConfigurePMEnabled(ViSession(vi), ViConstString(channelName), ViBoolean(enabled))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigurePMSource(self, vi, channelName, source):
        status = self.dll.tkafg3k_ConfigurePMSource(ViSession(vi), ViConstString(channelName), ViInt32(source))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigurePMInternalByChannel(self, vi, channelName, pmDeviation, pmWaveform, pmFrequency):
        status = self.dll.tkafg3k_ConfigurePMInternalByChannel(
            ViSession(vi),
            ViConstString(channelName),
            ViReal64(pmDeviation),
            ViInt32(pmWaveform),
            ViReal64(pmFrequency),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigurePMExternalByChannel(self, vi, channelName, pmDeviation):
        status = self.dll.tkafg3k_ConfigurePMExternalByChannel(
            ViSession(vi), ViConstString(channelName), ViReal64(pmDeviation)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureFSKEnabled(self, vi, channelName, enabled):
        status = self.dll.tkafg3k_ConfigureFSKEnabled(ViSession(vi), ViConstString(channelName), ViBoolean(enabled))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureFSKSource(self, vi, channelName, source):
        status = self.dll.tkafg3k_ConfigureFSKSource(ViSession(vi), ViConstString(channelName), ViInt32(source))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureFSKInternalByChannel(self, vi, channelName, hopFrequency, rate):
        status = self.dll.tkafg3k_ConfigureFSKInternalByChannel(
            ViSession(vi),
            ViConstString(channelName),
            ViReal64(hopFrequency),
            ViReal64(rate),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigureFSKExternalByChannel(self, vi, channelName, hopFrequency):
        status = self.dll.tkafg3k_ConfigureFSKExternalByChannel(
            ViSession(vi), ViConstString(channelName), ViReal64(hopFrequency)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigurePWMEnabled(self, vi, channelName, enabled):
        status = self.dll.tkafg3k_ConfigurePWMEnabled(ViSession(vi), ViConstString(channelName), ViBoolean(enabled))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigurePWMSource(self, vi, channelName, source):
        status = self.dll.tkafg3k_ConfigurePWMSource(ViSession(vi), ViConstString(channelName), ViInt32(source))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigurePWMInternalByChannel(self, vi, channelName, pwmDeviation, pwmWaveform, pwmFrequency):
        status = self.dll.tkafg3k_ConfigurePWMInternalByChannel(
            ViSession(vi),
            ViConstString(channelName),
            ViReal64(pwmDeviation),
            ViInt32(pwmWaveform),
            ViReal64(pwmFrequency),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ConfigurePWMExternalByChannel(self, vi, channelName, pwmDeviation):
        status = self.dll.tkafg3k_ConfigurePWMExternalByChannel(
            ViSession(vi), ViConstString(channelName), ViReal64(pwmDeviation)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def error_query(self, vi):
        errorCode = ViInt32()
        errorMessage = ARRAY_ViChar(1024)
        status = self.dll.tkafg3k_error_query(ViSession(vi), byref(errorCode), errorMessage)
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        errorCode = int(errorCode.value)
        errorMessage = decode(errorMessage)
        return errorCode, errorMessage

    def GetError(self, vi, bufferSize):
        code = ViStatus()
        description = ARRAY_ViChar(1024)
        status = self.dll.tkafg3k_GetError(ViSession(vi), byref(code), ViInt32(bufferSize), description)
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        description = decode(description)
        return code, description

    def ClearError(self, vi):
        status = self.dll.tkafg3k_ClearError(ViSession(vi))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def error_message(self, vi, errorCode):
        errorMessage = ARRAY_ViChar(256)
        status = self.dll.tkafg3k_error_message(ViSession(vi), ViStatus(errorCode), errorMessage)
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return decode(errorMessage)

    def GetNextInterchangeWarning(self, vi, bufferSize):
        warnString = ARRAY_ViChar(1024)
        status = self.dll.tkafg3k_GetNextInterchangeWarning(ViSession(vi), ViInt32(bufferSize), warnString)
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return decode(warnString)

    def ResetInterchangeCheck(self, vi):
        status = self.dll.tkafg3k_ResetInterchangeCheck(ViSession(vi))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ClearInterchangeWarnings(self, vi):
        status = self.dll.tkafg3k_ClearInterchangeWarnings(ViSession(vi))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def InvalidateAllAttributes(self, vi):
        status = self.dll.tkafg3k_InvalidateAllAttributes(ViSession(vi))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def reset(self, vi):
        status = self.dll.tkafg3k_reset(ViSession(vi))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ResetWithDefaults(self, vi):
        status = self.dll.tkafg3k_ResetWithDefaults(ViSession(vi))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def self_test(self, vi):
        selfTestResult = ViInt16()
        selfTestMessage = ARRAY_ViChar(1024)
        status = self.dll.tkafg3k_self_test(ViSession(vi), byref(selfTestResult), selfTestMessage)
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        selfTestResult = int(selfTestResult.value)
        selfTestMessage = decode(selfTestMessage)
        return selfTestResult, selfTestMessage

    def revision_query(self, vi):
        instrumentDriverRevision = ARRAY_ViChar(1024)
        firmwareRevision = ARRAY_ViChar(1024)
        status = self.dll.tkafg3k_revision_query(ViSession(vi), instrumentDriverRevision, firmwareRevision)
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        instrumentDriverRevision = decode(instrumentDriverRevision)
        firmwareRevision = decode(firmwareRevision)
        return instrumentDriverRevision, firmwareRevision

    def Disable(self, vi):
        status = self.dll.tkafg3k_Disable(ViSession(vi))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def SaveLoadInstrumentSettings(self, vi, operationSelect, fileName):
        status = self.dll.tkafg3k_SaveLoadInstrumentSettings(
            ViSession(vi), ViInt32(operationSelect), ViConstString(fileName)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def SaveLoadWaveformData(self, vi, operationSelect, fileName, editMemory):
        status = self.dll.tkafg3k_SaveLoadWaveformData(
            ViSession(vi),
            ViInt32(operationSelect),
            ViConstString(fileName),
            ViInt32(editMemory),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def SetGetWaveformPointValue(self, vi, pointIndex, pointValue, operationSelect, editMemory):
        queryValue = ViInt32()
        status = self.dll.tkafg3k_SetGetWaveformPointValue(
            ViSession(vi),
            ViInt32(pointIndex),
            ViInt32(pointValue),
            ViInt32(operationSelect),
            ViInt32(editMemory),
            byref(queryValue),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return int(queryValue.value)

    def CopyWfmDataBetweenEditMemory(self, vi, sourceMemory, targetMemory):
        status = self.dll.tkafg3k_CopyWfmDataBetweenEditMemory(
            ViSession(vi), ViInt32(sourceMemory), ViInt32(targetMemory)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def viWrite(self, vi, buffer, count):
        _buffer = (ViByte * len(buffer))(*buffer)
        returnCount = ViInt64()
        status = self.dll.tkafg3k_viWrite(ViSession(vi), _buffer, ViInt64(count), byref(returnCount))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return int(returnCount.value)

    def viRead(self, vi, bufferSize):
        buffer = ARRAY_ViByte(1024)
        returnCount = ViInt64()
        status = self.dll.tkafg3k_viRead(ViSession(vi), ViInt64(bufferSize), buffer, byref(returnCount))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        returnCount = int(returnCount.value)
        return buffer, returnCount

    def WriteInstrData(self, vi, writeBuffer):
        status = self.dll.tkafg3k_WriteInstrData(ViSession(vi), ViConstString(writeBuffer))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def ReadInstrData(self, vi, numBytes):
        rdBuf = ARRAY_ViChar(numBytes)
        bytesRead = ViInt32()
        status = self.dll.tkafg3k_ReadInstrData(ViSession(vi), ViInt32(numBytes), rdBuf, byref(bytesRead))
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        rdBuf = decode(rdBuf)
        bytesRead = int(bytesRead.value)
        return rdBuf, bytesRead

    def GetAttributeViInt32(self, vi, channelName, attribute):
        value = ViInt32()
        status = self.dll.tkafg3k_GetAttributeViInt32(
            ViSession(vi), ViConstString(channelName), ViAttr(attribute), byref(value)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return int(value.value)

    def GetAttributeViReal64(self, vi, channelName, attribute):
        value = ViReal64()
        status = self.dll.tkafg3k_GetAttributeViReal64(
            ViSession(vi), ViConstString(channelName), ViAttr(attribute), byref(value)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return float(value.value)

    def GetAttributeViString(self, vi, channelName, attribute, bufSize):
        value = ARRAY_ViChar(1024)
        status = self.dll.tkafg3k_GetAttributeViString(
            ViSession(vi),
            ViConstString(channelName),
            ViAttr(attribute),
            ViInt32(bufSize),
            value,
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return decode(value)

    def GetAttributeViSession(self, vi, channelName, attribute):
        value = ViSession()
        status = self.dll.tkafg3k_GetAttributeViSession(
            ViSession(vi), ViConstString(channelName), ViAttr(attribute), byref(value)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return int(value.value)

    def GetAttributeViBoolean(self, vi, channelName, attribute):
        value = ViBoolean()
        status = self.dll.tkafg3k_GetAttributeViBoolean(
            ViSession(vi), ViConstString(channelName), ViAttr(attribute), byref(value)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)
        return bool(value.value)

    def SetAttributeViInt32(self, vi, channelName, attribute, value):
        status = self.dll.tkafg3k_SetAttributeViInt32(
            ViSession(vi), ViConstString(channelName), ViAttr(attribute), ViInt32(value)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def SetAttributeViReal64(self, vi, channelName, attribute, value):
        status = self.dll.tkafg3k_SetAttributeViReal64(
            ViSession(vi), ViConstString(channelName), ViAttr(attribute), ViReal64(value)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def SetAttributeViString(self, vi, channelName, attribute, value):
        status = self.dll.tkafg3k_SetAttributeViString(
            ViSession(vi),
            ViConstString(channelName),
            ViAttr(attribute),
            ViConstString(value),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def SetAttributeViSession(self, vi, channelName, attribute, value):
        status = self.dll.tkafg3k_SetAttributeViSession(
            ViSession(vi), ViConstString(channelName), ViAttr(attribute), ViSession(value)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def SetAttributeViBoolean(self, vi, channelName, attribute, value):
        status = self.dll.tkafg3k_SetAttributeViBoolean(
            ViSession(vi), ViConstString(channelName), ViAttr(attribute), ViBoolean(value)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def CheckAttributeViInt32(self, vi, channelName, attribute, value):
        status = self.dll.tkafg3k_CheckAttributeViInt32(
            ViSession(vi), ViConstString(channelName), ViAttr(attribute), ViInt32(value)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def CheckAttributeViReal64(self, vi, channelName, attribute, value):
        status = self.dll.tkafg3k_CheckAttributeViReal64(
            ViSession(vi), ViConstString(channelName), ViAttr(attribute), ViReal64(value)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def CheckAttributeViString(self, vi, channelName, attribute, value):
        status = self.dll.tkafg3k_CheckAttributeViString(
            ViSession(vi),
            ViConstString(channelName),
            ViAttr(attribute),
            ViConstString(value),
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def CheckAttributeViSession(self, vi, channelName, attribute, value):
        status = self.dll.tkafg3k_CheckAttributeViSession(
            ViSession(vi), ViConstString(channelName), ViAttr(attribute), ViSession(value)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return

    def CheckAttributeViBoolean(self, vi, channelName, attribute, value):
        status = self.dll.tkafg3k_CheckAttributeViBoolean(
            ViSession(vi), ViConstString(channelName), ViAttr(attribute), ViBoolean(value)
        )
        if int(status) < 0:
            raise InstrumentError(status)
        elif int(status) > 0:
            raise InstrumentWarning(status)

        return
