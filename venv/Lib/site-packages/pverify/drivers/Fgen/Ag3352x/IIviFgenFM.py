from __future__ import annotations

from .Ag3352x import *


class IIviFgenFM:
    def __init__(self, root):
        self.root = root

    @property
    def InternalDeviation(self):
        return self.root.dllwrap.GetAttributeViReal64(None, IVI_CLASS_PUBLIC_ATTR_BASE + 503)

    @InternalDeviation.setter
    def InternalDeviation(self, value):
        """
        The maximum frequency deviation the function generator applies to the carrier
        waveform when the FM Source attribute is set to FM Internal. Applies only when
        the FM Source attribute is set to FM Internal.
        """
        self.root.dllwrap.SetAttributeViReal64(None, IVI_CLASS_PUBLIC_ATTR_BASE + 503, value)

    @property
    def InternalFrequency(self):
        return self.root.dllwrap.GetAttributeViReal64(None, IVI_CLASS_PUBLIC_ATTR_BASE + 505)

    @InternalFrequency.setter
    def InternalFrequency(self, value):
        """
        The frequency of the internal modulating waveform source. The units are hertz.
        Applies only when the FM Source attribute is set to FM Internal.
        """
        self.root.dllwrap.SetAttributeViReal64(None, IVI_CLASS_PUBLIC_ATTR_BASE + 505, value)

    @property
    def InternalWaveform(self):
        return self.root.dllwrap.GetAttributeViInt32(None, IVI_CLASS_PUBLIC_ATTR_BASE + 504)

    @InternalWaveform.setter
    def InternalWaveform(self, value):
        """
        The waveform of the internal modulating waveform source. Applies only when the
        FM Source attribute is set to FM Internal.
        """
        self.root.dllwrap.SetAttributeViInt32(None, IVI_CLASS_PUBLIC_ATTR_BASE + 504, value)

    def ConfigureInternal(self, Deviation, Waveform, Frequency):
        """
        Configures the attributes that control the function generator's internal
        frequency modulating waveform source.

        :param Deviation: Specifies the internal modulation deviation. This value sets the FM Internal
            Deviation property.
        :type Deviation: float
        :param Waveform: Specifies the waveform the function generator uses for the internal modulating
            waveform source. This value sets the FM Internal Waveform property.
        :type Waveform: IviFgenFMInternalWaveformEnum
        :param Frequency: Specifies the frequency of the internal modulating waveform source. This value
            setsthe FM Internal Frequency property.
        :type Frequency: float
        """
        self.root.dllwrap.ConfigureFMInternal(Deviation, Waveform, Frequency)

    def get_Enabled(self, ChannelName):
        """
        Provides an indication whether FM is enabled on a channel.

        :param ChannelName: The name of a channel.
        :type ChannelName: str

        :return: True if the function generator applies frequency modulation to the signal that
            the function generator produces.
        :rtype: bool
        """
        return self.root.dllwrap.GetAttributeViBoolean(ChannelName, IVI_CLASS_PUBLIC_ATTR_BASE + 501)

    def get_Source(self, ChannelName):
        """
        The source of the signal that the function generator uses as the modulating
        waveform. Applies only when the FM Enabled attribute is set to True.

        :param ChannelName: The name of a channel.
        :type ChannelName: str

        :return: One of the values of IviFgenFMSourceEnum.
        :rtype: int
        """
        return self.root.dllwrap.GetAttributeViInt32(ChannelName, IVI_CLASS_PUBLIC_ATTR_BASE + 502)

    def set_Enabled(self, ChannelName, pVal):
        """
        Enables or disables AM on a channel.

        :param ChannelName: The name of a channel.
        :type ChannelName: str
        :param pVal: True enables FM.
        :type pVal: bool
        """
        self.root.dllwrap.SetAttributeViBoolean(ChannelName, IVI_CLASS_PUBLIC_ATTR_BASE + 501, pVal)

    def set_Source(self, ChannelName, pVal):
        """
        Selects the source of the signal that the function generator uses as the
        modulating waveform. Applies only when the FM Enabled attribute is set to True.

        :param ChannelName: The name of a channel.
        :type ChannelName: str
        :param pVal: One of the values of IviFgenFMSourceEnum.
        :type pVal: IviFgenFMSourceEnum
        """
        self.root.dllwrap.SetAttributeViInt32(ChannelName, IVI_CLASS_PUBLIC_ATTR_BASE + 502, pVal)
