from __future__ import annotations

from .hp33120a import *


class IIviFgenOutput:
    def __init__(self, root):
        self.root = root

    @property
    def OutputMode(self):
        return self.root.dllwrap.GetAttributeViInt32(None, IVI_CLASS_PUBLIC_ATTR_BASE + 1)

    @OutputMode.setter
    def OutputMode(self, value):
        """
        The mode that determines how the function generator produces waveforms. This
        attribute determines which extension group's functions and attributes are used
        to configure the waveform the function generator produces.
        """
        self.root.dllwrap.SetAttributeViInt32(None, IVI_CLASS_PUBLIC_ATTR_BASE + 1, value)

    @property
    def ReferenceClockSource(self):
        return self.root.dllwrap.GetAttributeViInt32(None, IVI_CLASS_PUBLIC_ATTR_BASE + 2)

    @ReferenceClockSource.setter
    def ReferenceClockSource(self, value):
        """
        The source of the reference clock. The function generator derives frequencies
        and sample rates that it uses to generate waveforms from the reference clock.
        """
        self.root.dllwrap.SetAttributeViInt32(None, IVI_CLASS_PUBLIC_ATTR_BASE + 2, value)

    @property
    def Count(self):
        return self.root.dllwrap.GetAttributeViInt32(None, IVI_ENGINE_PUBLIC_ATTR_BASE + 203)

    def get_Enabled(self, ChannelName):
        """
        Provides an indication whether the signal the function generator produces
        appears at the output connector.

        :param ChannelName: The ChannelName parameter may be a string defined by the driver or supplied as a
            virtual name in the configuration store. For single output instruments, the
            driver may define the empty string as valid ChannelName.
        :type ChannelName: str

        :return: True if the signal the function generator produces appears at the output
            connector.
        :rtype: bool
        """
        return self.root.dllwrap.GetAttributeViBoolean(ChannelName, IVI_CLASS_PUBLIC_ATTR_BASE + 3)

    def set_Enabled(self, ChannelName, pVal):
        """
        Sets whether the signal the function generator produces appears at the output
        connector.

        :param ChannelName: The ChannelName parameter may be a string defined by the driver or supplied as a
            virtual name in the configuration store. For single output instruments, the
            driver may define the empty string as valid ChannelName.
        :type ChannelName: str
        :param pVal: If true, the signal the function generator produces appears at the output
            connector.
        :type pVal: bool
        """
        self.root.dllwrap.SetAttributeViBoolean(ChannelName, IVI_CLASS_PUBLIC_ATTR_BASE + 3, pVal)

    def get_Impedance(self, ChannelName):
        """
        Retrieves a channel's impedance.

        :param ChannelName: The ChannelName parameter may be a string defined by the driver or supplied as a
            virtual name in the configuration store. For single output instruments, the
            driver may define the empty string as valid ChannelName.
        :type ChannelName: str

        :return: The impedance of the output channel. The units are Ohms.
        :rtype: float
        """
        return self.root.dllwrap.GetAttributeViReal64(ChannelName, IVI_CLASS_PUBLIC_ATTR_BASE + 4)

    def set_Impedance(self, ChannelName, pVal):
        """
        Sets channel's impedance.

        :param ChannelName: The ChannelName parameter may be a string defined by the driver or supplied as a
            virtual name in the configuration store. For single output instruments, the
            driver may define the empty string as valid ChannelName.
        :type ChannelName: str
        :param pVal: The impedance of the output channel. The units are Ohms.
        :type pVal: float
        """
        self.root.dllwrap.SetAttributeViReal64(ChannelName, IVI_CLASS_PUBLIC_ATTR_BASE + 4, pVal)

    def get_OperationMode(self, ChannelName):
        """
        Retrieves a channel's operation mode.

        :param ChannelName: The ChannelName parameter may be a string defined by the driver or supplied as a
            virtual name in the configuration store. For single output instruments, the
            driver may define the empty string as valid ChannelName.
        :type ChannelName: str

        :return: The mode that determines how the function generator produces output on a
            channel.
        :rtype: int
        """
        return self.root.dllwrap.GetAttributeViInt32(ChannelName, IVI_CLASS_PUBLIC_ATTR_BASE + 5)

    def set_OperationMode(self, ChannelName, pVal):
        """
        Sets a channel's operation mode.

        :param ChannelName: The ChannelName parameter may be a string defined by the driver or supplied as a
            virtual name in the configuration store. For single output instruments, the
            driver may define the empty string as valid ChannelName.
        :type ChannelName: str
        :param pVal: The mode that determines how the function generator produces output on a
            channel.
        :type pVal: IviFgenOperationModeEnum
        """
        self.root.dllwrap.SetAttributeViInt32(ChannelName, IVI_CLASS_PUBLIC_ATTR_BASE + 5, pVal)

    def Name(self, Index):
        """
        Retrieves the name of a channel.

        :param Index: The one-based index into the collection of channel names.
        :type Index: int

        :return: The name of the output channel specified.
        :rtype: str
        """
        return self.root.dllwrap.GetChannelName(Index, 256)
