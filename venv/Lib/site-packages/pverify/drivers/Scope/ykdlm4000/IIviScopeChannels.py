# -------------------------------------------------------------------------------
# Name           :
# Description    :
#
# Revision       : $Rev$
# Date           : $Date$
# Last change by : $Author$
# -------------------------------------------------------------------------------
from __future__ import annotations

from pverify.drivers.Scope.ykdlm4000 import IIviScopeBase
from pverify.drivers.Scope.ykdlm4000.IIviScopeChannel import IIviScopeChannel


class IIviScopeChannels(IIviScopeBase.IIviScopeBase):
    """IVI Scope class-compliant channel collection interface.

    NOTE:
        Attributes/Methods marked with '#' do not exist for this instrument.
        Attributes/Methods marked with '*' are specific for this instrument.
        !Please consider when trying to program instrument independent.

    Methods:
        Item
            An interface reference pointer to one of the IviScopeChannel
            interfaces which is selected by the channel name.

        Count
            The number of channels.

        Name
            The channel name for a given index.

    """

    def __init__(self, parent):
        self.parent = parent
        if False:
            from .IIviScope import IIviScope

            self.parent = IIviScope()
        IIviScopeBase.IIviScopeBase.__init__(self, self.parent.interface)
        self.__channels = {
            "C1": IIviScopeChannel(self.interface, "1"),
            "C2": IIviScopeChannel(self.interface, "2"),
            "C3": IIviScopeChannel(self.interface, "3"),
            "C4": IIviScopeChannel(self.interface, "4"),
            "C5": IIviScopeChannel(self.interface, "5"),
            "C6": IIviScopeChannel(self.interface, "6"),
            "C7": IIviScopeChannel(self.interface, "7"),
            "C8": IIviScopeChannel(self.interface, "8"),
        }

    # Read only dependent properties
    @property
    def Count(self):
        """
        The number of channels.

        :return: int
        """
        return 8

    # Methods
    def Item(self, Name):
        """
        Returns a pointer to a channel object.

        :param Name: Channel name: "C1", "C2", "C3", "C4", "C5", "C6", "C7", "C8"
        :type Name: int
        :rtype: IIviScopeChannel
        """
        return self.__channels[str(Name)]

    def Name(self, Index):
        """
        Returns the name of a channel.

        :param Index:
            Valid values are between one and the value of the Channel Count property.
            If the user passes an invalid value for the Index parameter, the value of this property is an empty string
        :type Index: int
        """
        if isinstance(Index, int) and 1 <= Index <= 8:
            return ["C1", "C2", "C3", "C4", "C5", "C6", "C7", "C8"][Index - 1]
        else:
            msg = "ykdlm4000: Channel index exceeds the limits 1-8"
            raise IndexError(msg)
