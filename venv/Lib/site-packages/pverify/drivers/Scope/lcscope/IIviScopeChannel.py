from __future__ import annotations

from .lcscope import *


class IIviScopeChannel:
    def __init__(self, root, channel=""):
        self.root = root
        self.channel = str(channel)

    @property
    def ProbeSense(self):
        return self.root.dllwrap.GetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 108)

    @property
    def Coupling(self):
        return self.root.dllwrap.GetAttributeViInt32(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 3)

    @Coupling.setter
    def Coupling(self, value):
        """
        How the oscilloscope couples the input signal.
        """
        self.root.dllwrap.SetAttributeViInt32(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 3, value)

    @property
    def Enabled(self):
        return self.root.dllwrap.GetAttributeViBoolean(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 5)

    @Enabled.setter
    def Enabled(self, value):
        """
        If True, the oscilloscope acquires a waveform for this channel when the Initiate
        Acquisition, Read Waveform, Read Min Max Waveform, or Read Waveform Measurement
        methods are called.
        """
        self.root.dllwrap.SetAttributeViBoolean(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 5, value)

    @property
    def InputFrequencyMax(self):
        return self.root.dllwrap.GetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 6)

    @InputFrequencyMax.setter
    def InputFrequencyMax(self, value):
        """
        The maximum input frequency of this channel. It the frequency at which the input
        circuitry attenuates the input signal by 3 dB. The units are hertz.
        """
        self.root.dllwrap.SetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 6, value)

    @property
    def InputImpedance(self):
        return self.root.dllwrap.GetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 103)

    @InputImpedance.setter
    def InputImpedance(self, value):
        """
        The input impedance of this channel. The units are ohms.
        """
        self.root.dllwrap.SetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 103, value)

    @property
    def Offset(self):
        return self.root.dllwrap.GetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 2)

    @Offset.setter
    def Offset(self, value):
        """
        The location of the center of the range that you specify with the Range
        property. The units are volts, with respect to ground. For example, to acquire a
        sine wave spanning 0.0 to 10.0 volts, set Offset to 5.0 volts.
        """
        self.root.dllwrap.SetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 2, value)

    @property
    def ProbeAttenuation(self):
        return self.root.dllwrap.GetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 4)

    @ProbeAttenuation.setter
    def ProbeAttenuation(self, value):
        """
        The scaling factor by which the probe attenuates the input signal. For example,
        with a 10:1 probe, the value is 10.0.
        """
        self.root.dllwrap.SetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 4, value)

    @property
    def Range(self):
        return self.root.dllwrap.GetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 1)

    @Range.setter
    def Range(self, value):
        """
        The absolute value of the input range the oscilloscope can acquire for the
        channel. The units are volts. For example, to acquire a sine wave spanning -5.0
        to 5.0 volts, set Range to 10.0 volts.
        """
        self.root.dllwrap.SetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 1, value)

    def Configure(self, Range, Offset, Coupling, ProbeAttenuation, Enabled):
        """
        Configures the most commonly used properties of the oscilloscope channel
        sub-system. They are the range, offset, coupling, probe attenuation, and whether
        the channel is enabled.

        :param Range: Specifies the vertical range. This value sets the Vertical Range property.
        :type Range: float
        :param Offset: Specifies the vertical offset. This value sets the Vertical Offset property.
        :type Offset: float
        :param Coupling: Specifies how to couple the input signal. This value sets the Vertical
        :type Coupling: IviScopeVerticalCouplingEnum
        :param ProbeAttenuation: Specifies the probe attenuation. This value sets the Probe Attenuation property.
        :type ProbeAttenuation: float
        :param Enabled: Specifies if the channel is enabled for acquisition. This value sets the Channel
            Enabled property.
        :type Enabled: bool
        """
        self.root.dllwrap.ConfigureChannel(self.channel, Range, Offset, Coupling, ProbeAttenuation, Enabled)

    def ConfigureCharacteristics(self, InputImpedance, InputFrequencyMax):
        """
        Configures the properties that control the electrical characteristics of the
        channel. They are the input impedance and the maximum frequency of the input
        signal.

        :param InputImpedance: The input impedance for the channel. The driver sets the Input Impedance to this
            value.
        :type InputImpedance: float
        :param InputFrequencyMax: The maximum input frequency for the channel. The driver sets the Max Input
            Frequency to this value.
        :type InputFrequencyMax: float
        """
        self.root.dllwrap.ConfigureChanCharacteristics(self.channel, InputImpedance, InputFrequencyMax)
