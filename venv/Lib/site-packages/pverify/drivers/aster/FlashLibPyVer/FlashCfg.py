from __future__ import annotations

import copy
from collections import OrderedDict

_cfg_dict = {
    "Connection": OrderedDict(
        [
            ("@id", "0"),
            (
                "Driver",
                OrderedDict(
                    [
                        ("@name", "flash.MemtoolCli"),
                        (
                            "MemtoolExe",
                            "C:/Program Files (x86)/Infineon/Memtool 4.7/IMTMemtool.exe",
                        ),
                        (
                            "MemtoolCli",
                            "C:/userdata/PTE_Tools/pls/UDE_4_08_04/MemtoolCli.exe",
                        ),
                    ]
                ),
            ),
            ("DAS_PORT", "0"),
            (
                "MEMTOOL_CFG",
                "C:/Users/SinghaAk/Documents/Infineon/IMT4.7/Targets/TriBoard_TC39xA_das.cfg",
            ),
        ]
    )
}
bin_file = "Demo.hex"


class FlashCfg:
    @staticmethod
    def getdefault():
        """Function to retrive the default configuration in the form of a dictonary."""
        return copy.deepcopy(_cfg_dict)

    @staticmethod
    def update_cfg_flash(cfg_dict, Drivername, MemtoolExe, MemtoolCli, MEMTOOL_CFG, hex):
        """Function to update the configuration.

        :param cfg_dict: The configuration dict which need to be updated.
        :type cfg_dict: dict
        :param Drivername: The Tool used for Flash..
        :type Drivername: dict
        :param MemtoolExe: MemtoolExe Path.
        :type MemtoolExe: str
        :param MemtoolCli: MemtoolCli Path.
        :type MemtoolCli: str
        :param MEMTOOL_CFG: Configuration file path.
        :type MEMTOOL_CFG: str
        :param hex: Hex file/files to be flashed.
        :type hex: list
        """
        cfg_dict["Connection"]["Driver"]["@name"] = Drivername
        cfg_dict["Connection"]["MEMTOOL_CFG"] = MEMTOOL_CFG
        cfg_dict["Connection"]["Driver"]["MemtoolCli"] = MemtoolCli
        cfg_dict["Connection"]["Driver"]["MemtoolExe"] = MemtoolExe
        bin_file = hex
        return cfg_dict, bin_file
