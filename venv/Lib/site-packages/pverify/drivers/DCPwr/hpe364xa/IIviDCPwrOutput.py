from __future__ import annotations

from .hpe364xa import *


class IIviDCPwrOutput:
    def __init__(self, root, channel=None):
        self.root = root
        self.channel = str(channel)

    @property
    def Enabled(self):
        return self.root.dllwrap.GetAttributeViBoolean(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 6)

    @Enabled.setter
    def Enabled(self, value):
        """
        property Enabled specifies whether the signal the power supply produces appears
        at the output connector.
        """
        self.root.dllwrap.SetAttributeViBoolean(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 6, value)

    @property
    def TriggerSource(self):
        return self.root.dllwrap.GetAttributeViInt32(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 101)

    @TriggerSource.setter
    def TriggerSource(self, value):
        """
        property Source specifies the trigger source.
        """
        self.root.dllwrap.SetAttributeViInt32(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 101, value)

    @property
    def TriggeredCurrentLimit(self):
        return self.root.dllwrap.GetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 102)

    @TriggeredCurrentLimit.setter
    def TriggeredCurrentLimit(self, value):
        """
        property Triggered Current Limit specifies the value to which the power supply
        sets the current limit after a trigger event occurs.
        """
        self.root.dllwrap.SetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 102, value)

    @property
    def TriggeredVoltageLevel(self):
        return self.root.dllwrap.GetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 103)

    @TriggeredVoltageLevel.setter
    def TriggeredVoltageLevel(self, value):
        """
        property Triggerd Voltage Level specifies the value to which the power supply
        sets the voltage level after a trigger event occurs.
        """
        self.root.dllwrap.SetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 103, value)

    @property
    def VoltageLevel(self):
        return self.root.dllwrap.GetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 1)

    @VoltageLevel.setter
    def VoltageLevel(self, value):
        """
        property Voltage Level specifies the voltage level the DC power supply attempts
        to generate. The units are Volts.
        """
        self.root.dllwrap.SetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 1, value)

    @property
    def CurrentLimit(self):
        return self.root.dllwrap.GetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 5)

    @CurrentLimit.setter
    def CurrentLimit(self, value):
        """
        propety Current Limit specifies the output current limit. The units are Amps.
        """
        self.root.dllwrap.SetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 5, value)

    @property
    def CurrentLimitBehavior(self):
        return self.root.dllwrap.GetAttributeViInt32(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 4)

    @CurrentLimitBehavior.setter
    def CurrentLimitBehavior(self, value):
        """
        property Current Limit Behavior specifies the behavior of the power supply when
        the output current is equal to or greater than the value of the Current Limit
        property.
        """
        self.root.dllwrap.SetAttributeViInt32(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 4, value)

    @property
    def OVPLimit(self):
        return self.root.dllwrap.GetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 3)

    @OVPLimit.setter
    def OVPLimit(self, value):
        """
        property OVP Limit specifies the voltage the power supply allows. The units are
        Volts.
        """
        self.root.dllwrap.SetAttributeViReal64(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 3, value)

    @property
    def OVPEnabled(self):
        return self.root.dllwrap.GetAttributeViBoolean(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 2)

    @OVPEnabled.setter
    def OVPEnabled(self, value):
        """
        property OVP Enabled specifies whether the power supply provides over-voltage
        protection. If this property is set to True, the power supply disables the
        output when the output voltage is greater than or equal to the OVP Limit.
        """
        self.root.dllwrap.SetAttributeViBoolean(self.channel, IVI_CLASS_PUBLIC_ATTR_BASE + 2, value)

    def ConfigureCurrentLimit(self, Behavior, Limit):
        """
        method Configure Current Limit specifies the output current limit value and the
        behavior of the power supply when the output current is greater than or equal to
        that value.

        :param Behavior: Specifies the behavior of the power supply when the output current is greater
            than or equal to the value of the Limit parameter. The driver uses this value to
            set the Current Limit Behavior attribute. See the attribute description for more
            details.
        :type Behavior: IviDCPwrCurrentLimitBehaviorEnum
        :param Limit: Specifies the power supply's output current limit. The driver uses this value to
            set the Current Limit attribute.
        :type Limit: float
        """
        self.root.dllwrap.ConfigureCurrentLimit(self.channel, Behavior, Limit)

    def ConfigureRange(self, RangeType, Range):
        """
        method Configure Range specifies the output's range, either current or voltage.

        :param RangeType: The kind of range to be configured, either Current or Voltage.
        :type RangeType: IviDCPwrRangeTypeEnum
        :param Range: The range in which the power supply operates. This value is coerced to the
            closest value the instrument supports that is greater than or equal to the value
            specified.
        :type Range: float
        """
        self.root.dllwrap.ConfigureOutputRange(self.channel, RangeType, Range)

    def ConfigureOVP(self, Enabled, Limit):
        """
        method Configure OVP specifies the over-voltage limit and the behavior of the
        power supply when the output voltage is greater than or equal to the limit.

        :param Enabled: Specifies the behavior of the power supply when the ouptut voltage is greater
            than or equal to the value of the Limit parameter. This value sets the OVP
            Enabled property.
        :type Enabled: bool
        :param Limit: Specifies the power supply's over-voltage protection limit. This value sets the
            OVP Limit property
        :type Limit: float
        """
        self.root.dllwrap.ConfigureOVP(self.channel, Enabled, Limit)

    def Measure(self, MeasurementType):
        """
        method Measure takes a measurement on the output signal and returns the measured
        value.

        :param MeasurementType: The type of measurement to take, either Current or Volatge
        :type MeasurementType: IviDCPwrMeasurementTypeEnum

        :return: The measured value.
        :rtype: float
        """
        return self.root.dllwrap.Measure(self.channel, MeasurementType)

    def QueryCurrentLimitMax(self, VoltageLevel):
        """
        method Query Current Limit Max returns the maximum programmable current limit
        that the power supply accepts for a particular voltage level on an output.

        :param VoltageLevel: The voltage level for which to determine the maximum programmable current limit.
        :type VoltageLevel: float

        :return: Returns the maximum programmable current limit for the specified voltage level.
        :rtype: float
        """
        return self.root.dllwrap.QueryMaxCurrentLimit(self.channel, VoltageLevel)

    def QueryState(self, OutputState):
        """
        method Query State returns whether the power supply is in a particular output
        state.

        :param OutputState: The output state for which to query. Allowed values are those defined in the
            IviDCPwrOutputStateEnum enumeration.
        :type OutputState: IviDCPwrOutputStateEnum

        :return: Returns True if the power supply is currently in the state specified with the
            OutputState parameter, and False if it is not.
        :rtype: int
        """
        return self.root.dllwrap.QueryOutputState(self.channel, OutputState)

    def QueryVoltageLevelMax(self, CurrentLimit):
        """
        method Query Voltage Level Max returns the maximum programmable voltage level
        that the power supply accepts for a particular current limit on an output.

        :param CurrentLimit: The current limit for which to determine the maximum programmable voltage level.
        :type CurrentLimit: float

        :return: Returns the maximum programmable voltage level for the specified current limit.
        :rtype: float
        """
        return self.root.dllwrap.QueryMaxVoltageLevel(self.channel, CurrentLimit)

    def ResetOutputProtection(self):
        """
        method Reset Output Protection resets the power supply's output protection after
        an over-voltage or over-current condition occurs.
        """
        self.root.dllwrap.ResetOutputProtection(self.channel)
