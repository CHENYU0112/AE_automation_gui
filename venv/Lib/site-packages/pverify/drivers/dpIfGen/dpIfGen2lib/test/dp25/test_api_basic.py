from __future__ import annotations

import os
import unittest

from dpIfGen2lib.test.dp25.support.interface_box_persistent import IFP

# set an environment variable to bring API into test mode
# todo find a nicer way to do that
os.environ["TEST_ENV_DP_TOOLS_2016-04-15"] = "true"
os.environ["INTERFACE_BOX"] = "dp25"

from dpIfGen2lib.dpIfGen2API.com_dpifgen2_api_basic import DpIfGen2APIBasic

IFP.set_firmware_id(["0000", "0000", "0000", "0000"])


class TestAPIBasic(unittest.TestCase):
    def test_connection_establish(self):
        api = DpIfGen2APIBasic()
        api.connection_establish()
        assert True is IFP.is_synchronized()

    def test_memory_write_and_read_works(self):
        api = DpIfGen2APIBasic()
        api.connection_establish()
        api.memory_write("8000", "1234")
        assert api.memory_read("8000") == "1234"
